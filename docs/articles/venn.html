<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Comparing two datasets with Venn Diagram • CAIBIrnaseq</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Comparing two datasets with Venn Diagram">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CAIBIrnaseq</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/installation.html">Installation Guide</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">References</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples">
<li><a class="dropdown-item" href="../articles/unsup_rnaseq.html">Unsupervised analysis</a></li>
    <li><a class="dropdown-item" href="../articles/sup_rnaseq.html">Supervised analysis</a></li>
    <li><a class="dropdown-item" href="../articles/venn.html">Comparing datasets</a></li>
    <li><a class="dropdown-item" href="../articles/pathview.html">Pathview</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="venn_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="venn_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="venn_files/plotly-binding-4.10.4/plotly.js"></script><script src="venn_files/typedarray-0.1/typedarray.min.js"></script><link href="venn_files/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="venn_files/crosstalk-1.2.1/js/crosstalk.min.js"></script><link href="venn_files/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="venn_files/plotly-main-2.11.1/plotly-latest.min.js"></script><script src="venn_files/kePrint-0.0.1/kePrint.js"></script><link href="venn_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Comparing two datasets with Venn Diagram</h1>
                        <h4 data-toc-skip class="author">Cordeliers
Artificial Intelligence and Bioinformatics</h4>
            
            <h4 data-toc-skip class="date">2025-05-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/crcordeliers/CAIBIrnaseq.git/blob/HEAD/vignettes/venn.Rmd" class="external-link"><code>vignettes/venn.Rmd</code></a></small>
      <div class="d-none name"><code>venn.Rmd</code></div>
    </div>

    
    
<p><img src="../reference/figures/CAIBI.png" align="right" alt="" width="120"></p>
<p>Here is an example of an application for the function
<code>plot_venn</code>. For this script, we used 2 different public
datasets <code>airway</code> and <code>macrophage</code>.</p>
<p>If you want to use this notebook for your projects, it is available
<a href="https://github.com/crcordeliers/CAIBIrnaseq/blob/dev/vignettes/venn.Rmd" class="external-link">here</a></p>
<p>The <code>airway</code> dataset provides a gene expression dataset
derived from <strong>human bronchial epithelial cells</strong>, treated
or not with <strong>dexamethasone</strong> (a corticosteroid).</p>
<p>The <code>macrophage</code> dataset provides bulk RNA-seq count data
from <strong>human monocyte-derived macrophages</strong>. These cells
were either left untreated or stimulated with interferon-gamma
(IFN-γ).<br>
An experimental condition was applied to each of these cells, left
<strong>unstimulated</strong>, stimulated with
<strong>IFN-gamma</strong>, infected with <strong>SL1344</strong>, or
pre-treated with <strong>IFN-g</strong> and then infected with
<strong>SL1344</strong>. For this comparison, we will focus on the
samples of the 2 first conditions (IFN-g, naive).</p>
<p>To compare the datasets, we will do the pre-processing part of the
sup and unsup analysis, until the diffexp.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">annotation_air</span> <span class="op">&lt;-</span> <span class="st">"dex"</span></span>
<span><span class="va">annotation_mac</span> <span class="op">&lt;-</span> <span class="st">"condition_name"</span></span>
<span></span>
<span><span class="va">diffexpMethod</span> <span class="op">&lt;-</span> <span class="st">"limma"</span></span></code></pre></div>
<div class="section level2">
<h2 id="import-libraries">Import libraries<a class="anchor" aria-label="anchor" href="#import-libraries"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">airway</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/SummarizedExperiment" class="external-link">SummarizedExperiment</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">macrophage</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Huber-group-EMBL/biomaRt" class="external-link">biomaRt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://crcordeliers.github.io/CAIBIrnaseq">CAIBIrnaseq</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="load-datasets">Load datasets<a class="anchor" aria-label="anchor" href="#load-datasets"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Loading the 2 datasets</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">airway</span>, package<span class="op">=</span><span class="st">"airway"</span><span class="op">)</span>; </span>
<span><span class="va">airway</span> <span class="op">&lt;-</span> <span class="va">airway</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"gse"</span><span class="op">)</span></span>
<span><span class="va">macrophage</span> <span class="op">&lt;-</span> <span class="va">gse</span>; <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">gse</span><span class="op">)</span></span>
<span><span class="va">macrophage</span> <span class="op">&lt;-</span> <span class="va">macrophage</span><span class="op">[</span>,<span class="va">macrophage</span><span class="op">$</span><span class="va">condition</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"naive"</span>, <span class="st">"IFNg"</span><span class="op">)</span><span class="op">]</span> <span class="co"># focus on these 2 conditions</span></span></code></pre></div>
<p>Even if the datasets are globally build the same way, the names of
the variables are not exactly the same, so if we want to keep the same
code, we need to redefine a bit the variables.</p>
<p>If you want to know what are the used variables in this part, run
this command line :
<code>colnames(SummarizedExperiment::rowData(exp_data))</code></p>
<p>You should have these variables (with these exact same names):<br>
- <strong>gene_name</strong> : The commonly used symbol or name for the
gene (e.g., A1BG).<br>
- <strong>gene_id</strong> : A unique and stable identifier for the
gene, often from databases like Ensembl (e.g., ENSG00000141510).<br>
- <strong>gene_length_kb</strong> : The length of the gene measured in
kilobases<br>
- <strong>gene_description</strong> : A brief textual summary of the
gene’s function or characteristics, often pulled from annotation
databases.<br>
- <strong>gene_biotype</strong> : A classification of the gene based on
its biological function or transcript type, such as protein_coding,
lncRNA, or pseudogene.</p>
<p>If not, you should look at how your dataset is defined. You might
need to run some command line as the following ones:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">airway</span><span class="op">)</span><span class="op">$</span><span class="va">gene_length_kb</span> <span class="op">&lt;-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">airway</span><span class="op">)</span><span class="op">$</span><span class="va">gene_seq_end</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">airway</span><span class="op">)</span><span class="op">$</span><span class="va">gene_seq_start</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1000</span></span>
<span></span>
<span><span class="va">mart_air</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/biomaRt/man/useEnsembl.html" class="external-link">useEnsembl</a></span><span class="op">(</span><span class="st">"ensembl"</span>, dataset <span class="op">=</span> <span class="st">"hsapiens_gene_ensembl"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gene_ids_air</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">airway</span><span class="op">)</span><span class="op">$</span><span class="va">gene_id</span></span>
<span></span>
<span><span class="va">annot_air</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/biomaRt/man/getBM.html" class="external-link">getBM</a></span><span class="op">(</span>attributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ensembl_gene_id"</span>, <span class="st">"description"</span><span class="op">)</span>,</span>
<span>               filters <span class="op">=</span> <span class="st">"ensembl_gene_id"</span>,</span>
<span>               values <span class="op">=</span> <span class="va">gene_ids_air</span>,</span>
<span>               mart <span class="op">=</span> <span class="va">mart_air</span><span class="op">)</span></span>
<span></span>
<span><span class="va">matched_air</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">airway</span><span class="op">)</span><span class="op">$</span><span class="va">gene_id</span>, <span class="va">annot_air</span><span class="op">$</span><span class="va">ensembl_gene_id</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">airway</span><span class="op">)</span><span class="op">$</span><span class="va">gene_description</span> <span class="op">&lt;-</span> <span class="va">annot_air</span><span class="op">$</span><span class="va">description</span><span class="op">[</span><span class="va">matched_air</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">macrophage</span><span class="op">)</span><span class="op">$</span><span class="va">gene_length_kb</span> <span class="op">&lt;-</span> <span class="fu">width</span><span class="op">(</span><span class="fu">rowRanges</span><span class="op">(</span><span class="va">macrophage</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">macrophage</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"\\..*$"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">macrophage</span><span class="op">)</span><span class="op">$</span><span class="va">gene_id</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">macrophage</span><span class="op">)</span><span class="op">$</span><span class="va">gene_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"\\..*$"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">macrophage</span><span class="op">)</span><span class="op">$</span><span class="va">gene_id</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">macrophage</span><span class="op">)</span><span class="op">$</span><span class="va">gene_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">macrophage</span><span class="op">)</span><span class="op">$</span><span class="va">SYMBOL</span></span>
<span></span>
<span><span class="va">macrophage</span> <span class="op">&lt;-</span> <span class="va">macrophage</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">macrophage</span><span class="op">)</span><span class="op">$</span><span class="va">SYMBOL</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">mart_mac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/biomaRt/man/useEnsembl.html" class="external-link">useEnsembl</a></span><span class="op">(</span><span class="st">"ensembl"</span>, dataset <span class="op">=</span> <span class="st">"hsapiens_gene_ensembl"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">annot_mac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/biomaRt/man/getBM.html" class="external-link">getBM</a></span><span class="op">(</span></span>
<span>  attributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ensembl_gene_id"</span>, <span class="st">"gene_biotype"</span>, <span class="st">"description"</span><span class="op">)</span>,</span>
<span>  filters <span class="op">=</span> <span class="st">"ensembl_gene_id"</span>,</span>
<span>  values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">macrophage</span><span class="op">)</span><span class="op">$</span><span class="va">gene_id</span><span class="op">)</span>,</span>
<span>  mart <span class="op">=</span> <span class="va">mart_mac</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Correspondance entre gene_id et annot_mac</span></span>
<span><span class="va">match_mac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">macrophage</span><span class="op">)</span><span class="op">$</span><span class="va">gene_id</span>, <span class="va">annot_mac</span><span class="op">$</span><span class="va">ensembl_gene_id</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ajouter les colonnes dans rowData</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">macrophage</span><span class="op">)</span><span class="op">$</span><span class="va">gene_biotype</span> <span class="op">&lt;-</span> <span class="va">annot_mac</span><span class="op">$</span><span class="va">gene_biotype</span><span class="op">[</span><span class="va">match_mac</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">macrophage</span><span class="op">)</span><span class="op">$</span><span class="va">gene_description</span> <span class="op">&lt;-</span> <span class="va">annot_mac</span><span class="op">$</span><span class="va">description</span><span class="op">[</span><span class="va">match_mac</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="pre-processing">Pre-processing<a class="anchor" aria-label="anchor" href="#pre-processing"></a>
</h2>
<p>Most datasets use ensembl gene ID by default after alignment, so this
step rebases the expression data to gene names. This ensures consistency
in naming for downstream analyses.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">airway</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rebase_gexp.html">rebase_gexp</a></span><span class="op">(</span><span class="va">airway</span>, annotation <span class="op">=</span> <span class="st">"gene_name"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">macrophage</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rebase_gexp.html">rebase_gexp</a></span><span class="op">(</span><span class="va">macrophage</span>, annotation <span class="op">=</span> <span class="st">"SYMBOL"</span><span class="op">)</span> <span class="co"># or gene_name if you renamed the variable </span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="filter">Filter<a class="anchor" aria-label="anchor" href="#filter"></a>
</h2>
<p>Here, we filter out genes expressed in too few samples or with very
low counts. This removes noise from the data and focuses on meaningful
gene expressions.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">airway</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_gexp.html">filter_gexp</a></span><span class="op">(</span><span class="va">airway</span>,</span>
<span>                        min_nsamp <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                        min_counts <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">macrophage</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_gexp.html">filter_gexp</a></span><span class="op">(</span><span class="va">macrophage</span>,</span>
<span>                        min_nsamp <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                        min_counts <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="quality-control">Quality Control<a class="anchor" aria-label="anchor" href="#quality-control"></a>
</h3>
<p>Visualization of the filtering process to ensure the criteria applied
align with the dataset’s characteristics:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">airway</span><span class="op">)</span><span class="op">$</span><span class="va">sample_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">airway</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_qc_filters.html">plot_qc_filters</a></span><span class="op">(</span><span class="va">airway</span><span class="op">)</span></span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"data":[{"x":[5000,5000],"y":[0,33900036.5],"text":"","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,28378.900000000001],"y":[5000000,5000000],"text":"","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[24483,24384,25517,23006,25341,25799,24513,23867],"y":[20637971,18809481,25348649,15163415,24448408,30818215,19126151,21164133],"text":["sample_id: SRR1039508<br />qc_status: QC pass","sample_id: SRR1039509<br />qc_status: QC pass","sample_id: SRR1039512<br />qc_status: QC pass","sample_id: SRR1039513<br />qc_status: QC pass","sample_id: SRR1039516<br />qc_status: QC pass","sample_id: SRR1039517<br />qc_status: QC pass","sample_id: SRR1039520<br />qc_status: QC pass","sample_id: SRR1039521<br />qc_status: QC pass"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"QC pass","legendgroup":"QC pass","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.824636418824401,"r":7.3059360730593621,"b":41.778974318367787,"l":54.794520547945211},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0,28378.900000000001],"tickmode":"array","ticktext":["0","10000","20000"],"tickvals":[0,10000,20000],"categoryorder":"array","categoryarray":["0","10000","20000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Number of genes with non-zero counts","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0,33900036.5],"tickmode":"array","ticktext":["0e+00","1e+07","2e+07","3e+07"],"tickvals":[0,10000000,20000000,30000000],"categoryorder":"array","categoryarray":["0e+00","1e+07","2e+07","3e+07"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Total number of counts","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"QC status","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"e6856bc1eada":{"xintercept":{},"type":"scatter"},"e685380fac0e":{"yintercept":{}},"e6853bb6df51":{"x":{},"y":{},"label":{},"colour":{}},"e68554f1abb4":{"x":{},"y":{},"label":{}}},"cur_data":"e6856bc1eada","visdat":{"e6856bc1eada":["function (y) ","x"],"e685380fac0e":["function (y) ","x"],"e6853bb6df51":["function (y) ","x"],"e68554f1abb4":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">macrophage</span><span class="op">)</span><span class="op">$</span><span class="va">sample_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">macrophage</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_qc_filters.html">plot_qc_filters</a></span><span class="op">(</span><span class="va">macrophage</span><span class="op">)</span></span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-e5c8c404fe174e4c81bd" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"data":[{"x":[5000,5000],"y":[0,49843138.280100003],"text":"","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,21360.900000000001],"y":[5000000,5000000],"text":"","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[18415,18452,18305,18041,18587,18132,17633,17365,18601,17998,19419,19329],"y":[39638783.067000002,40016103.265000001,40103549.685999997,39122151.620999999,38744103.164999999,37332333.439000003,32872544.756999999,31217353.963,33681896.777000003,33028250.567000002,45311943.891000003,40828291.689999998],"text":["sample_id: SAMEA103885102<br />qc_status: QC pass","sample_id: SAMEA103885347<br />qc_status: QC pass","sample_id: SAMEA103885182<br />qc_status: QC pass","sample_id: SAMEA103885136<br />qc_status: QC pass","sample_id: SAMEA103885368<br />qc_status: QC pass","sample_id: SAMEA103885218<br />qc_status: QC pass","sample_id: SAMEA103885284<br />qc_status: QC pass","sample_id: SAMEA103885059<br />qc_status: QC pass","sample_id: SAMEA103885111<br />qc_status: QC pass","sample_id: SAMEA103884919<br />qc_status: QC pass","sample_id: SAMEA103885262<br />qc_status: QC pass","sample_id: SAMEA103885228<br />qc_status: QC pass"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"hoveron":"points","name":"QC pass","legendgroup":"QC pass","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.824636418824401,"r":7.3059360730593621,"b":41.778974318367787,"l":54.794520547945211},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0,21360.900000000001],"tickmode":"array","ticktext":["0","5000","10000","15000","20000"],"tickvals":[0,5000,10000,15000,20000],"categoryorder":"array","categoryarray":["0","5000","10000","15000","20000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Number of genes with non-zero counts","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0,49843138.280100003],"tickmode":"array","ticktext":["0e+00","1e+07","2e+07","3e+07","4e+07"],"tickvals":[0,10000000,20000000,30000000,40000000],"categoryorder":"array","categoryarray":["0e+00","1e+07","2e+07","3e+07","4e+07"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Total number of counts","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"QC status","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"e6856ae108e6":{"xintercept":{},"type":"scatter"},"e685411bf59":{"yintercept":{}},"e6853b2504d7":{"x":{},"y":{},"label":{},"colour":{}},"e68561dc9048":{"x":{},"y":{},"label":{}}},"cur_data":"e6856ae108e6","visdat":{"e6856ae108e6":["function (y) ","x"],"e685411bf59":["function (y) ","x"],"e6853b2504d7":["function (y) ","x"],"e68561dc9048":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="section level2">
<h2 id="normalize">Normalize<a class="anchor" aria-label="anchor" href="#normalize"></a>
</h2>
<p>Here, we apply a normalization to the expression data, making samples
comparable by reducing variability due to technical differences. For
datasets with few samples, <code>rlog</code> is the preferred
normalization and when more samples are present, <code>vst</code> is
applied.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">airway</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalize_gexp.html">normalize_gexp</a></span><span class="op">(</span><span class="va">airway</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">macrophage</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">macrophage</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">macrophage</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalize_gexp.html">normalize_gexp</a></span><span class="op">(</span><span class="va">macrophage</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="pca">PCA<a class="anchor" aria-label="anchor" href="#pca"></a>
</h2>
<p>Principal component analysis (PCA) identifies the major patterns in
the dataset. These patterns help explore similarities or differences
among samples based on gene expression.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#|message: false</span></span>
<span><span class="fu">metadata</span><span class="op">(</span><span class="va">airway</span><span class="op">)</span><span class="op">[[</span><span class="st">"pca_res"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pca_gexp.html">pca_gexp</a></span><span class="op">(</span><span class="va">airway</span><span class="op">)</span></span>
<span><span class="va">annotations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">annotation_air</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exp_cluster"</span>, <span class="st">"path_cluster"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_pca.html">plot_pca</a></span><span class="op">(</span><span class="va">airway</span>, color <span class="op">=</span> <span class="va">annotation_air</span><span class="op">)</span></span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-36aa3d2a04d42bbc2145" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-36aa3d2a04d42bbc2145">{"x":{"data":[{"x":[14.839069421975847,24.593807654692181,16.383181911026984,25.967675811227551],"y":[5.0172517058590902,9.0421838417274021,-30.394274516115658,11.425730228598246],"text":["sample_id: SRR1039509<br />dex: trt","sample_id: SRR1039513<br />dex: trt","sample_id: SRR1039517<br />dex: trt","sample_id: SRR1039521<br />dex: trt"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"trt","legendgroup":"trt","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-21.384638314040082,-19.659551572912438,-20.542436740837015,-20.197108171133014],"y":[10.241576532822902,9.2251012769538185,-31.202632473378614,16.645063403532838],"text":["sample_id: SRR1039508<br />dex: untrt","sample_id: SRR1039512<br />dex: untrt","sample_id: SRR1039516<br />dex: untrt","sample_id: SRR1039520<br />dex: untrt"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)"}},"hoveron":"points","name":"untrt","legendgroup":"untrt","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-23.752254020303464,28.335291517490933],"y":[0,0],"text":"","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(127,127,127,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0],"y":[-33.595017267224186,19.03744819737841],"text":"","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(127,127,127,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.824636418824401,"r":7.3059360730593621,"b":41.778974318367787,"l":43.105022831050235},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-23.752254020303464,28.335291517490933],"tickmode":"array","ticktext":["-20","-10","0","10","20"],"tickvals":[-20,-10,0,10.000000000000004,20.000000000000004],"categoryorder":"array","categoryarray":["-20","-10","0","10","20"],"nticks":null,"ticks":"outside","tickcolor":"rgba(0,0,0,1)","ticklen":3.6529680365296811,"tickwidth":0.33208800332088001,"showticklabels":true,"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(222,222,222,1)","gridwidth":0.33208800332088001,"zeroline":false,"anchor":"y","title":{"text":"PC 1 (24.6%)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-33.595017267224186,19.03744819737841],"tickmode":"array","ticktext":["-30","-20","-10","0","10"],"tickvals":[-30,-20,-10,0,10],"categoryorder":"array","categoryarray":["-30","-20","-10","0","10"],"nticks":null,"ticks":"outside","tickcolor":"rgba(0,0,0,1)","ticklen":3.6529680365296811,"tickwidth":0.33208800332088001,"showticklabels":true,"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(222,222,222,1)","gridwidth":0.33208800332088001,"zeroline":false,"anchor":"x","title":{"text":"PC 2 (18.6%)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(0,0,0,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"dex","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"e6854e0769d9":{"label":{},"x":{},"y":{},"colour":{},"type":"scatter"},"e68513e127e8":{"yintercept":{}},"e6851ccd865c":{"xintercept":{}}},"cur_data":"e6854e0769d9","visdat":{"e6854e0769d9":["function (y) ","x"],"e68513e127e8":["function (y) ","x"],"e6851ccd865c":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">metadata</span><span class="op">(</span><span class="va">macrophage</span><span class="op">)</span><span class="op">[[</span><span class="st">"pca_res"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pca_gexp.html">pca_gexp</a></span><span class="op">(</span><span class="va">macrophage</span><span class="op">)</span></span>
<span><span class="va">annotations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">annotation_mac</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exp_cluster"</span>, <span class="st">"path_cluster"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_pca.html">plot_pca</a></span><span class="op">(</span><span class="va">macrophage</span>, color <span class="op">=</span> <span class="va">annotation_mac</span><span class="op">)</span></span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-febe03efa1a2d8d52a86" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-febe03efa1a2d8d52a86">{"x":{"data":[{"x":[-21.938811297897367,-4.3014668628277821,-20.399707359280757,-21.683741197064389,8.2901983620153796,50.769801433876971],"y":[-11.929570140219523,-21.737877398513294,-21.397246399693582,-13.045855314365928,-21.158448094894801,-12.097291243264781],"text":["sample_id: SAMEA103885347<br />condition_name: IFNg","sample_id: SAMEA103885136<br />condition_name: IFNg","sample_id: SAMEA103885218<br />condition_name: IFNg","sample_id: SAMEA103885059<br />condition_name: IFNg","sample_id: SAMEA103884919<br />condition_name: IFNg","sample_id: SAMEA103885228<br />condition_name: IFNg"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"IFNg","legendgroup":"IFNg","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-20.094865671767483,-0.69010275789494724,-20.036382926893836,-21.17785659250044,13.062353186705165,58.200581683529435],"y":[20.312429756966978,9.824483909298662,20.514073299138602,20.444547129719087,17.4539771806757,12.81677731515291],"text":["sample_id: SAMEA103885102<br />condition_name: naive","sample_id: SAMEA103885182<br />condition_name: naive","sample_id: SAMEA103885368<br />condition_name: naive","sample_id: SAMEA103885284<br />condition_name: naive","sample_id: SAMEA103885111<br />condition_name: naive","sample_id: SAMEA103885262<br />condition_name: naive"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":1,"size":7.559055118110237,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)"}},"hoveron":"points","name":"naive","legendgroup":"naive","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-25.945780946968707,62.207551332600772],"y":[0,0],"text":"","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(127,127,127,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0],"y":[-23.850474933395891,22.626670834021198],"text":"","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(127,127,127,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.824636418824401,"r":7.3059360730593621,"b":41.778974318367787,"l":43.105022831050235},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-25.945780946968707,62.207551332600772],"tickmode":"array","ticktext":["-20","0","20","40","60"],"tickvals":[-20,0,20.000000000000004,40,60],"categoryorder":"array","categoryarray":["-20","0","20","40","60"],"nticks":null,"ticks":"outside","tickcolor":"rgba(0,0,0,1)","ticklen":3.6529680365296811,"tickwidth":0.33208800332088001,"showticklabels":true,"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(222,222,222,1)","gridwidth":0.33208800332088001,"zeroline":false,"anchor":"y","title":{"text":"PC 1 (40.2%)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-23.850474933395891,22.626670834021198],"tickmode":"array","ticktext":["-20","-10","0","10","20"],"tickvals":[-20,-10,0,9.9999999999999964,19.999999999999996],"categoryorder":"array","categoryarray":["-20","-10","0","10","20"],"nticks":null,"ticks":"outside","tickcolor":"rgba(0,0,0,1)","ticklen":3.6529680365296811,"tickwidth":0.33208800332088001,"showticklabels":true,"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(222,222,222,1)","gridwidth":0.33208800332088001,"zeroline":false,"anchor":"x","title":{"text":"PC 2 (16.6%)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(0,0,0,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"condition_name","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"e6856b27c11e":{"label":{},"x":{},"y":{},"colour":{},"type":"scatter"},"e6853e809003":{"yintercept":{}},"e685652b072f":{"xintercept":{}}},"cur_data":"e6856b27c11e","visdat":{"e6856b27c11e":["function (y) ","x"],"e6853e809003":["function (y) ","x"],"e685652b072f":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="diffexp">Diffexp<a class="anchor" aria-label="anchor" href="#diffexp"></a>
</h2>
<p><strong>Differential expression analysis</strong> is a key step in
RNA-seq data interpretation. It aims to identify genes whose expression
levels significantly change between experimental conditions—in this
case, between treated and untreated airway samples, and between
IFNg-stimulated and naive macrophages. By statistically testing gene
expression differences, this analysis highlights <strong>biologically
relevant genes</strong> that may be involved in <strong>specific
cellular responses or disease mechanisms</strong>. .</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioinf.wehi.edu.au/edgeR/" class="external-link">edgeR</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">airway</span><span class="op">)</span><span class="op">$</span><span class="va">dex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">airway</span><span class="op">)</span><span class="op">$</span><span class="va">dex</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">airway</span><span class="op">)</span><span class="op">$</span><span class="va">dex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">airway</span><span class="op">)</span><span class="op">$</span><span class="va">dex</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"untrt"</span>, <span class="st">"trt"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">diffexp_air</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/diffExpAnalysis.html">diffExpAnalysis</a></span><span class="op">(</span>countData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assays</a></span><span class="op">(</span><span class="va">airway</span><span class="op">)</span><span class="op">$</span><span class="va">counts</span>,</span>
<span>                                          sampleInfo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">airway</span><span class="op">)</span>,</span>
<span>                                          method <span class="op">=</span> <span class="va">diffexpMethod</span>, cutoff <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                                          annotation <span class="op">=</span> <span class="va">annotation_air</span><span class="op">)</span></span></code></pre></div>
<p><img src="venn_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">macrophage</span><span class="op">)</span><span class="op">$</span><span class="va">condition_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">macrophage</span><span class="op">)</span><span class="op">$</span><span class="va">condition_name</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">macrophage</span><span class="op">)</span><span class="op">$</span><span class="va">condition_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">macrophage</span><span class="op">)</span><span class="op">$</span><span class="va">condition_name</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"IFNg"</span>, <span class="st">"naive"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">diffexp_mac</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/diffExpAnalysis.html">diffExpAnalysis</a></span><span class="op">(</span>countData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assays</a></span><span class="op">(</span><span class="va">macrophage</span><span class="op">)</span><span class="op">$</span><span class="va">counts</span>,</span>
<span>                                          sampleInfo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">macrophage</span><span class="op">)</span>,</span>
<span>                                          method <span class="op">=</span> <span class="va">diffexpMethod</span>, cutoff <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                                          annotation <span class="op">=</span> <span class="va">annotation_mac</span><span class="op">)</span></span></code></pre></div>
<p><img src="venn_files/figure-html/unnamed-chunk-12-2.png" width="700">
## Venn Diagram</p>
<p>Once the diffexp done, we can plot the venn diagram. Since the
datasets are not directly related, it could be interesting to see if
there are still similarities. The comparison can be made between genes,
pathways, …</p>
<p>If there are similarities, it can means that some biological
processes are activated for different condition types.</p>
<p>This diagram show us how much genes are unique to one dataset, and
which are in common. The fisher test value corresponds to the
reliability of this analysis. The nearer it is to 0, the most
significant this analysis is.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#|message: false</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">diffexpMethod</span><span class="op">)</span> <span class="op">==</span> <span class="st">"limma"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">diffexp_air</span> <span class="op">&lt;-</span> <span class="va">diffexp_air</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>      log2FoldChange <span class="op">=</span> <span class="va">logFC</span>,</span>
<span>      pvalue <span class="op">=</span> <span class="va">P.Value</span>,</span>
<span>      padj <span class="op">=</span> <span class="va">adj.P.Val</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">diffexpMethod</span><span class="op">)</span> <span class="op">==</span> <span class="st">"limma"</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">diffexp_mac</span> <span class="op">&lt;-</span> <span class="va">diffexp_mac</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>      log2FoldChange <span class="op">=</span> <span class="va">logFC</span>,</span>
<span>      pvalue <span class="op">=</span> <span class="va">P.Value</span>,</span>
<span>      padj <span class="op">=</span> <span class="va">adj.P.Val</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Exemple : extraction des degs_airgènes DE significatifs</span></span>
<span><span class="va">degs_air</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">diffexp_air</span><span class="op">[</span><span class="va">diffexp_air</span><span class="op">$</span><span class="va">padj</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">degs_mac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">diffexp_mac</span><span class="op">[</span><span class="va">diffexp_mac</span><span class="op">$</span><span class="va">padj</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="co"># universe_size &lt;- length(union(degs_air, degs_mac))</span></span>
<span><span class="va">universe_size</span> <span class="op">&lt;-</span> <span class="fl">7000</span></span>
<span></span>
<span><span class="co"># Diagramme de Venn</span></span>
<span><span class="fu"><a href="../reference/plot_venn.html">plot_venn</a></span><span class="op">(</span><span class="va">degs_air</span>, <span class="va">degs_mac</span>, <span class="va">universe_size</span>,</span>
<span>          v1_name <span class="op">=</span> <span class="st">"Airway"</span>, v2_name <span class="op">=</span> <span class="st">"Macrophage"</span>,</span>
<span>          fills <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lightgreen"</span>, <span class="st">"skyblue"</span><span class="op">)</span>,</span>
<span>          title <span class="op">=</span> <span class="st">"DEGs communs et spécifiques"</span><span class="op">)</span></span></code></pre></div>
<p><img src="venn_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">degs_air</span>, <span class="va">degs_mac</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">msigdbr</span><span class="fu">::</span><span class="fu"><a href="https://igordot.github.io/msigdbr/reference/msigdbr_collections.html" class="external-link">msigdbr_collections</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html" class="external-link">kbl</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/scroll_box.html" class="external-link">scroll_box</a></span><span class="op">(</span>height <span class="op">=</span> <span class="st">"300px"</span><span class="op">)</span></span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; ">
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
gs_collection
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
gs_subcollection
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
gs_collection_name
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
num_genesets
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
C1
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Positional
</td>
<td style="text-align:right;">
302
</td>
</tr>
<tr>
<td style="text-align:left;">
C2
</td>
<td style="text-align:left;">
CGP
</td>
<td style="text-align:left;">
Chemical and Genetic Perturbations
</td>
<td style="text-align:right;">
3494
</td>
</tr>
<tr>
<td style="text-align:left;">
C2
</td>
<td style="text-align:left;">
CP
</td>
<td style="text-align:left;">
Canonical Pathways
</td>
<td style="text-align:right;">
19
</td>
</tr>
<tr>
<td style="text-align:left;">
C2
</td>
<td style="text-align:left;">
CP:BIOCARTA
</td>
<td style="text-align:left;">
BioCarta Pathways
</td>
<td style="text-align:right;">
292
</td>
</tr>
<tr>
<td style="text-align:left;">
C2
</td>
<td style="text-align:left;">
CP:KEGG_LEGACY
</td>
<td style="text-align:left;">
KEGG Legacy Pathways
</td>
<td style="text-align:right;">
186
</td>
</tr>
<tr>
<td style="text-align:left;">
C2
</td>
<td style="text-align:left;">
CP:KEGG_MEDICUS
</td>
<td style="text-align:left;">
KEGG Medicus Pathways
</td>
<td style="text-align:right;">
658
</td>
</tr>
<tr>
<td style="text-align:left;">
C2
</td>
<td style="text-align:left;">
CP:PID
</td>
<td style="text-align:left;">
PID Pathways
</td>
<td style="text-align:right;">
196
</td>
</tr>
<tr>
<td style="text-align:left;">
C2
</td>
<td style="text-align:left;">
CP:REACTOME
</td>
<td style="text-align:left;">
Reactome Pathways
</td>
<td style="text-align:right;">
1736
</td>
</tr>
<tr>
<td style="text-align:left;">
C2
</td>
<td style="text-align:left;">
CP:WIKIPATHWAYS
</td>
<td style="text-align:left;">
WikiPathways
</td>
<td style="text-align:right;">
830
</td>
</tr>
<tr>
<td style="text-align:left;">
C3
</td>
<td style="text-align:left;">
MIR:MIRDB
</td>
<td style="text-align:left;">
miRDB
</td>
<td style="text-align:right;">
2377
</td>
</tr>
<tr>
<td style="text-align:left;">
C3
</td>
<td style="text-align:left;">
MIR:MIR_LEGACY
</td>
<td style="text-align:left;">
MIR_Legacy
</td>
<td style="text-align:right;">
221
</td>
</tr>
<tr>
<td style="text-align:left;">
C3
</td>
<td style="text-align:left;">
TFT:GTRD
</td>
<td style="text-align:left;">
GTRD
</td>
<td style="text-align:right;">
505
</td>
</tr>
<tr>
<td style="text-align:left;">
C3
</td>
<td style="text-align:left;">
TFT:TFT_LEGACY
</td>
<td style="text-align:left;">
TFT_Legacy
</td>
<td style="text-align:right;">
610
</td>
</tr>
<tr>
<td style="text-align:left;">
C4
</td>
<td style="text-align:left;">
3CA
</td>
<td style="text-align:left;">
Curated Cancer Cell Atlas gene sets
</td>
<td style="text-align:right;">
148
</td>
</tr>
<tr>
<td style="text-align:left;">
C4
</td>
<td style="text-align:left;">
CGN
</td>
<td style="text-align:left;">
Cancer Gene Neighborhoods
</td>
<td style="text-align:right;">
427
</td>
</tr>
<tr>
<td style="text-align:left;">
C4
</td>
<td style="text-align:left;">
CM
</td>
<td style="text-align:left;">
Cancer Modules
</td>
<td style="text-align:right;">
431
</td>
</tr>
<tr>
<td style="text-align:left;">
C5
</td>
<td style="text-align:left;">
<a href="GO:BP" class="uri">GO:BP</a>
</td>
<td style="text-align:left;">
GO Biological Process
</td>
<td style="text-align:right;">
7608
</td>
</tr>
<tr>
<td style="text-align:left;">
C5
</td>
<td style="text-align:left;">
<a href="GO:CC" class="uri">GO:CC</a>
</td>
<td style="text-align:left;">
GO Cellular Component
</td>
<td style="text-align:right;">
1026
</td>
</tr>
<tr>
<td style="text-align:left;">
C5
</td>
<td style="text-align:left;">
<a href="GO:MF" class="uri">GO:MF</a>
</td>
<td style="text-align:left;">
GO Molecular Function
</td>
<td style="text-align:right;">
1820
</td>
</tr>
<tr>
<td style="text-align:left;">
C5
</td>
<td style="text-align:left;">
HPO
</td>
<td style="text-align:left;">
Human Phenotype Ontology
</td>
<td style="text-align:right;">
5653
</td>
</tr>
<tr>
<td style="text-align:left;">
C6
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Oncogenic Signature
</td>
<td style="text-align:right;">
189
</td>
</tr>
<tr>
<td style="text-align:left;">
C7
</td>
<td style="text-align:left;">
IMMUNESIGDB
</td>
<td style="text-align:left;">
ImmuneSigDB
</td>
<td style="text-align:right;">
4872
</td>
</tr>
<tr>
<td style="text-align:left;">
C7
</td>
<td style="text-align:left;">
VAX
</td>
<td style="text-align:left;">
HIPC Vaccine Response
</td>
<td style="text-align:right;">
347
</td>
</tr>
<tr>
<td style="text-align:left;">
C8
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Cell Type Signature
</td>
<td style="text-align:right;">
840
</td>
</tr>
<tr>
<td style="text-align:left;">
H
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Hallmark
</td>
<td style="text-align:right;">
50
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#|message: false</span></span>
<span><span class="va">diffexp_air</span><span class="op">$</span><span class="va">gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">diffexp_air</span><span class="op">)</span></span>
<span><span class="va">diffexp_mac</span><span class="op">$</span><span class="va">gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">diffexp_mac</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Gènes significatifs (par exemple padj &lt; 0.05)</span></span>
<span><span class="va">sig_air</span> <span class="op">&lt;-</span> <span class="va">diffexp_air</span><span class="op">[</span><span class="va">diffexp_air</span><span class="op">$</span><span class="va">padj</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="op">]</span></span>
<span><span class="va">sig_mac</span> <span class="op">&lt;-</span> <span class="va">diffexp_mac</span><span class="op">[</span><span class="va">diffexp_mac</span><span class="op">$</span><span class="va">padj</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Gènes en commun (par nom de gène)</span></span>
<span><span class="va">common_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">sig_air</span><span class="op">$</span><span class="va">gene</span>, <span class="va">sig_mac</span><span class="op">$</span><span class="va">gene</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sous-ensemble des jeux avec uniquement les gènes communs</span></span>
<span><span class="va">common_air</span> <span class="op">&lt;-</span> <span class="va">diffexp_air</span><span class="op">[</span><span class="va">diffexp_air</span><span class="op">$</span><span class="va">gene</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">common_genes</span>, <span class="op">]</span></span>
<span><span class="va">common_mac</span> <span class="op">&lt;-</span> <span class="va">diffexp_mac</span><span class="op">[</span><span class="va">diffexp_mac</span><span class="op">$</span><span class="va">gene</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">common_genes</span>, <span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_exp_volcano.html">plot_exp_volcano</a></span><span class="op">(</span><span class="va">common_air</span>, <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<p><img src="venn_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_exp_volcano.html">plot_exp_volcano</a></span><span class="op">(</span><span class="va">common_mac</span>, <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<p><img src="venn_files/figure-html/unnamed-chunk-15-2.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="st">"results"</span>, <span class="st">"airway"</span>, <span class="st">"pathways"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="st">"results"</span>, <span class="st">"macrophage"</span>, <span class="st">"pathways"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pathway_collections</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CP:KEGG_MEDICUS"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pathways</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_annotation_collection.html">get_annotation_collection</a></span><span class="op">(</span><span class="va">pathway_collections</span>, </span>
<span>                                      species <span class="op">=</span> <span class="st">"human"</span><span class="op">)</span></span>
<span><span class="va">scores_airway</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/score_pathways.html">score_pathways</a></span><span class="op">(</span><span class="va">airway</span>, <span class="va">pathways</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">scores_macrophage</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/score_pathways.html">score_pathways</a></span><span class="op">(</span><span class="va">macrophage</span>, <span class="va">pathways</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Identifier les pathways communs</span></span>
<span><span class="va">common_paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">scores_airway</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">scores_macrophage</span><span class="op">)</span><span class="op">)</span><span class="co">## Warning in prep_scores_hm(exp_data, progeny_scores): 'sample_id' already exists</span></span>
<span></span>
<span><span class="co"># Définir un ordre commun basé sur les scores moyens dans airway</span></span>
<span><span class="va">order_common</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MatrixGenerics/man/rowMeans.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">scores_airway</span><span class="op">[</span><span class="va">common_paths</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span>decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Re-générer les heatmaps dans le même ordre</span></span>
<span><span class="va">collections</span> <span class="op">&lt;-</span> <span class="va">pathway_collections</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span>collapse <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html" class="external-link">str_remove</a></span><span class="op">(</span><span class="st">"\\:"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Réordonner les matrices selon cet ordre</span></span>
<span><span class="va">scores_airway</span> <span class="op">&lt;-</span> <span class="va">scores_airway</span><span class="op">[</span><span class="va">order_common</span>, <span class="op">]</span></span>
<span><span class="va">scores_macrophage</span> <span class="op">&lt;-</span> <span class="va">scores_macrophage</span><span class="op">[</span><span class="va">order_common</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Remplacer les anciennes matrices dans les objets</span></span>
<span><span class="fu">metadata</span><span class="op">(</span><span class="va">airway</span><span class="op">)</span><span class="op">[[</span><span class="st">"pathway_scores"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">scores_airway</span></span>
<span><span class="fu">metadata</span><span class="op">(</span><span class="va">macrophage</span><span class="op">)</span><span class="op">[[</span><span class="st">"pathway_scores"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">scores_macrophage</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="st">"results"</span>, <span class="st">"airway"</span>, <span class="st">"pathways"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="st">"results"</span>, <span class="st">"macrophage"</span>, <span class="st">"pathways"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># airway</span></span>
<span><span class="fu"><a href="../reference/plot_pathway_heatmap.html">plot_pathway_heatmap</a></span><span class="op">(</span><span class="va">airway</span>, annotations <span class="op">=</span> <span class="va">annotation_air</span>,</span>
<span>                     fwidth <span class="op">=</span> <span class="fl">9</span>,</span>
<span>                     cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                     fname <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html" class="external-link">str_glue</a></span><span class="op">(</span><span class="st">"results/airway/pathways/hm_paths_{collections}_top20_aligned.pdf"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="venn_files/figure-html/unnamed-chunk-16-1.png" width="960"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># macrophage</span></span>
<span><span class="fu"><a href="../reference/plot_pathway_heatmap.html">plot_pathway_heatmap</a></span><span class="op">(</span><span class="va">macrophage</span>, annotations <span class="op">=</span> <span class="va">annotation_mac</span>,</span>
<span>                     fwidth <span class="op">=</span> <span class="fl">9</span>,</span>
<span>                     cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                     fname <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html" class="external-link">str_glue</a></span><span class="op">(</span><span class="st">"results/macrophage/pathways/hm_paths_{collections}_top20_aligned.pdf"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="venn_files/figure-html/unnamed-chunk-16-2.png" width="960"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Clarice Groeneveld, Chloe Witz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
