---
title: "README for CAIBIrnaseq"
author: "Cordeliers Artificial Intelligence and Bioinformatics"
output: 
  html_document:
    toc: true
editor_options: 
  markdown: default
---
# CAIBIrnaseq

**CAIBIrnaseq** is an R package developed by the CAIBI platform for the supervised and unsupervised analysis of bulk RNA sequencing (RNA-seq) data.

It provides a complete pipeline for preprocessing, quality control, normalization, dimensionality reduction, clustering, pathway analysis, and data visualization. This package is designed to be flexible and integrates seamlessly with popular bioinformatics tools like `DESeq2`, `GSVA`, and `MCPcounter`.

## ‚öôÔ∏è Functions

Below is a summary of the available functions, grouped by their purpose in the RNA-seq analysis workflow.

### **üßπ Preprocessing & Filtering**

- `gexp_preprocess.R`: Main pipeline for preprocessing the gene expression matrix (filtering, normalization, etc.).
- `filter_gexp.R`: Applies gene- or sample-level filters based on user-defined thresholds.
- `normalize_gexp.R`: Normalizes raw gene expression data (log2 transformation, scaling, etc.).
- `read_rnaseq_out.R`: Reads the output files from RNA-seq processing pipelines and prepares them for analysis.
- `rebase_gexp.R`: Re-indexes or aligns the gene expression matrix to a common gene set.
- `highly_variable_genes.R`: Detects the most variable genes across samples for downstream dimensionality reduction.

### **üìä Visualization**

- `plot_exp_heatmap.R`: Heatmap of expression levels across samples or groups.
- `plot_exp_boxplot.R`: Boxplot visualization for selected gene(s) expression across conditions.
- `plot_exp_scatter.R`: Scatter plots of gene expression values.
- `plot_pathway_heatmap.R`: Heatmap of pathway scores (e.g., GSVA).
- `plot_path_boxplot.R`: Boxplot of pathway activity scores across conditions.
- `plot_path_scatter.R`: Scatter plot of pathway scores.
- `plot_progeny_heatmap.R`: Heatmap showing pathway activity using the PROGENy method.
- `plot_microenv_heatmap.R`: Heatmap for microenvironment estimation results (e.g., MCP-counter).
- `plt_boxplot.R`, `plt_heatmap.R`, `plt_scatter.R`: Internal helper functions for standardized plotting.

### **üß™ Dimensionality Reduction & Clustering**

- `pca_gexp.R`: Runs PCA on gene expression data and returns PCA results.
- `plot_pca.R`: Visualizes PCA output with group annotation.
- `cluster_exp.R`: Clusters gene expression profiles using hierarchical or k-means clustering.
- `cluster_k_hc.R`: Applies k-means or hierarchical clustering with a customizable number of clusters.

### **üß¨ Pathway & Annotation Handling**

- `get_pathway_genes.R`: Retrieves genes associated with selected pathways.
- `get_annotation_collection.R`: Loads a gene set collection (e.g., MSigDB, Reactome).
- `get_exp_df.R`: Formats expression data into a dataframe for plotting.
- `get_pathway_df.R`: Prepares a tidy dataframe of pathway scores for visualization.

### **üìà Scoring & Enrichment**

- `mcp_counter.R`: Runs MCP-counter to estimate immune and stromal cell populations in bulk RNA-seq data.
- `prep_scores_hm.R`: Prepares a matrix of scores (e.g., GSVA, PROGENy) for heatmap visualization.
- `prep_exp_hm.R`: Formats expression data for heatmap visualization.
- `prep_scored_hm.R`: Combines expression and score-based data into a unified heatmap input.

### **üóÇÔ∏è Metadata Utilities**

- `cluster_metadata.R`: Extracts and organizes metadata (e.g., conditions, clusters) for downstream analysis.
